# é«˜å¾·åœ°å›¾è½¨è¿¹å›æ”¾ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºé«˜å¾·åœ°å›¾JavaScript APIçš„è½¨è¿¹å›æ”¾ç³»ç»Ÿï¼Œæ”¯æŒå¤šè½¨è¿¹åŒæ—¶æ’­æ”¾ã€è¿›åº¦æ¡æ§åˆ¶å’Œæ—¶é—´æ˜¾ç¤ºã€‚

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… è½¨è¿¹æ•°æ®å›æ”¾åŠ¨ç”»
- âœ… è¿›åº¦æ¡æ‹–æ‹½æ§åˆ¶
- âœ… å®æ—¶æ—¶é—´æ˜¾ç¤ºï¼ˆå¼€å§‹æ—¶é—´ã€å½“å‰æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼‰
- âœ… æ’­æ”¾/æš‚åœ/é‡ç½®æ§åˆ¶
- âœ… å¤šå€é€Ÿæ’­æ”¾ï¼ˆ0.5x, 1x, 2x, 4xï¼‰
- âœ… å¤šè½¨è¿¹åŒæ—¶å›æ”¾
- âœ… è½¨è¿¹æ˜¾ç¤º/éšè—åˆ‡æ¢
- âœ… é”®ç›˜å¿«æ·é”®æ”¯æŒ

### äº¤äº’åŠŸèƒ½
- ğŸ® ç©ºæ ¼é”®ï¼šæ’­æ”¾/æš‚åœ
- ğŸ® Ré”®ï¼šé‡ç½®æ’­æ”¾
- ğŸ® å·¦å³ç®­å¤´ï¼šå¿«è¿›/å¿«é€€5ç§’
- ğŸ® æ•°å­—é”®1-4ï¼šåˆ‡æ¢æ’­æ”¾é€Ÿåº¦
- ğŸ–±ï¸ è¿›åº¦æ¡ç‚¹å‡»/æ‹–æ‹½ï¼šè·³è½¬åˆ°æŒ‡å®šæ—¶é—´
- ğŸ–±ï¸ è½¨è¿¹åˆ—è¡¨ï¼šåˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€

## å¿«é€Ÿå¼€å§‹

### 1. è·å–é«˜å¾·åœ°å›¾APIå¯†é’¥
1. è®¿é—® [é«˜å¾·å¼€æ”¾å¹³å°](https://lbs.amap.com/)
2. æ³¨å†Œè´¦å·å¹¶åˆ›å»ºåº”ç”¨
3. è·å–WebæœåŠ¡APIå¯†é’¥

### 2. é…ç½®APIå¯†é’¥
1. å¤åˆ¶ `api-config.example.js` ä¸º `api-config.js`
2. å°†æ–‡ä»¶ä¸­çš„ `YOUR_AMAP_API_KEY` æ›¿æ¢ä¸ºæ‚¨çš„å®é™…APIå¯†é’¥ï¼š

```javascript
window.AMAP_CONFIG = {
    apiKey: 'æ‚¨çš„é«˜å¾·åœ°å›¾APIå¯†é’¥'
};
```

**æ³¨æ„**ï¼š`api-config.js` æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore` ä¸­ï¼Œä¸ä¼šè¢«æäº¤åˆ°ä»£ç åº“ï¼Œç¡®ä¿æ‚¨çš„APIå¯†é’¥å®‰å…¨ã€‚

### 3. å¯åŠ¨åº”ç”¨
ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `index.html` æ–‡ä»¶å³å¯ã€‚

## æ•°æ®æ ¼å¼

### è½¨è¿¹æ•°æ®æ ¼å¼
```javascript
const trajectory = {
    id: 'trajectory1',           // è½¨è¿¹å”¯ä¸€æ ‡è¯†
    name: 'è½¨è¿¹åç§°',            // æ˜¾ç¤ºåç§°
    color: '#FF5722',           // è½¨è¿¹é¢œè‰²
    data: [                     // è½¨è¿¹ç‚¹æ•°æ®
        {
            time: '2025/07/14 14:59:33',    // æ—¶é—´æˆ³
            coords: [106.500692, 29.615953] // ç»çº¬åº¦åæ ‡ [ç»åº¦, çº¬åº¦]
        },
        // ... æ›´å¤šè½¨è¿¹ç‚¹
    ]
};
```

### åå°æ¥å£æ•°æ®æ ¼å¼
ç³»ç»Ÿæ”¯æŒä»¥ä¸‹æ ¼å¼çš„åå°æ•°æ®ï¼š
```javascript
[
    {
        time: '2025/07/14 14:59:33',
        coords: [106.500692, 29.615953]  // æ³¨æ„ï¼šåŸæ ¼å¼ä¸­çš„ condit åº”ä¸º coords
    },
    {
        time: '2025/07/14 15:00:34',
        coords: [106.500802, 29.615946]
    }
    // ... æ›´å¤šæ•°æ®ç‚¹
]
```

## API ä½¿ç”¨è¯´æ˜

### TrajectoryPlayer ç±»

#### åˆå§‹åŒ–
```javascript
const player = new TrajectoryPlayer('map-container', {
    center: [106.501642, 29.615994],  // åœ°å›¾ä¸­å¿ƒç‚¹
    zoom: 15,                         // ç¼©æ”¾çº§åˆ«
    animationDuration: 1000           // åŠ¨ç”»æŒç»­æ—¶é—´(ms)
});
```

#### ä¸»è¦æ–¹æ³•
```javascript
// æ·»åŠ è½¨è¿¹
player.addTrajectory(trajectory);

// æ’­æ”¾æ§åˆ¶
player.play();          // å¼€å§‹æ’­æ”¾
player.pause();         // æš‚åœæ’­æ”¾
player.reset();         // é‡ç½®åˆ°å¼€å§‹
player.seekTo(time);    // è·³è½¬åˆ°æŒ‡å®šæ—¶é—´
player.setPlaySpeed(2); // è®¾ç½®æ’­æ”¾é€Ÿåº¦

// è½¨è¿¹ç®¡ç†
player.toggleTrajectoryVisibility(id, visible); // åˆ‡æ¢è½¨è¿¹æ˜¾ç¤º
player.removeTrajectory(id);                     // ç§»é™¤è½¨è¿¹

// è®¾ç½®å›è°ƒ
player.setCallbacks({
    onTimeUpdate: (timeInfo) => { /* æ—¶é—´æ›´æ–°å›è°ƒ */ },
    onPlayStateChange: (stateInfo) => { /* æ’­æ”¾çŠ¶æ€å˜åŒ–å›è°ƒ */ }
});
```

### ProgressControl ç±»

#### åˆå§‹åŒ–
```javascript
const progressControl = new ProgressControl(player);
```

#### åŠŸèƒ½
- è‡ªåŠ¨åŒæ­¥æ’­æ”¾å™¨çŠ¶æ€
- å¤„ç†è¿›åº¦æ¡äº¤äº’
- æ›´æ–°æ—¶é—´æ˜¾ç¤º
- å¤„ç†é”®ç›˜å¿«æ·é”®

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ index.html              # ä¸»é¡µé¢
â”œâ”€â”€ style.css              # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ trajectory-player.js   # è½¨è¿¹æ’­æ”¾å™¨æ ¸å¿ƒç±»
â”œâ”€â”€ progress-control.js    # è¿›åº¦æ¡æ§åˆ¶ç»„ä»¶
â”œâ”€â”€ main.js               # ä¸»åº”ç”¨ç¨‹åº
â”œâ”€â”€ config.js             # ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”œâ”€â”€ api-config.js         # APIé…ç½®æ–‡ä»¶ï¼ˆéœ€è¦è‡ªå·±åˆ›å»ºï¼‰
â”œâ”€â”€ api-config.example.js # APIé…ç½®æ¨¡æ¿
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜
â””â”€â”€ .gitignore           # Gitå¿½ç•¥æ–‡ä»¶
```

## è‡ªå®šä¹‰å’Œæ‰©å±•

### æ·»åŠ æ–°çš„è½¨è¿¹æ•°æ®æº
```javascript
// ä»APIè·å–æ•°æ®
async function loadTrajectoryFromAPI(url) {
    const response = await fetch(url);
    const data = await response.json();
    
    const trajectory = {
        id: 'api_trajectory_' + Date.now(),
        name: 'æ¥è‡ªAPIçš„è½¨è¿¹',
        color: '#4CAF50',
        data: data.map(point => ({
            time: point.time,
            coords: point.coords  // ç¡®ä¿å­—æ®µåæ­£ç¡®
        }))
    };
    
    player.addTrajectory(trajectory);
}
```

### è‡ªå®šä¹‰æ ‡è®°æ ·å¼
```javascript
// åœ¨ TrajectoryPlayer ç±»ä¸­ä¿®æ”¹ createMarkerIcon æ–¹æ³•
createMarkerIcon(color) {
    return new AMap.Icon({
        size: new AMap.Size(32, 32),
        image: 'path/to/custom-marker.png'  // ä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡
    });
}
```

### æ·»åŠ è½¨è¿¹ç»Ÿè®¡ä¿¡æ¯
```javascript
// æ‰©å±•è½¨è¿¹ä¿¡æ¯æ˜¾ç¤º
function showTrajectoryStats(trajectory) {
    const stats = {
        totalPoints: trajectory.data.length,
        duration: trajectory.data[trajectory.data.length - 1].time - trajectory.data[0].time,
        distance: calculateDistance(trajectory.data)
    };
    
    console.log('è½¨è¿¹ç»Ÿè®¡:', stats);
}
```

## æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥å®‰å…¨**ï¼š
   - `api-config.js` æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå·²æ·»åŠ åˆ° `.gitignore` ä¸­
   - è¯·å‹¿å°†åŒ…å«çœŸå®APIå¯†é’¥çš„æ–‡ä»¶æäº¤åˆ°å…¬å…±ä»£ç åº“
   - å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å…¶ä»–å®‰å…¨æ–¹å¼ç®¡ç†APIå¯†é’¥

2. **APIå¯†é’¥é…ç½®**ï¼šè¯·ç¡®ä¿ä½¿ç”¨æœ‰æ•ˆçš„é«˜å¾·åœ°å›¾APIå¯†é’¥

3. **æ•°æ®æ ¼å¼**ï¼šç¡®ä¿è½¨è¿¹æ•°æ®ä¸­çš„åæ ‡æ ¼å¼ä¸º `[ç»åº¦, çº¬åº¦]`

4. **æ—¶é—´æ ¼å¼**ï¼šæ”¯æŒæ ‡å‡†çš„JavaScript Dateæ„é€ å‡½æ•°å¯è§£æçš„æ—¶é—´æ ¼å¼

5. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¤§é‡è½¨è¿¹ç‚¹æ—¶å»ºè®®è¿›è¡Œæ•°æ®æŠ½æ ·æˆ–åˆ†æ®µåŠ è½½

6. **æµè§ˆå™¨å…¼å®¹æ€§**ï¼šå»ºè®®ä½¿ç”¨ç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariã€Edgeï¼‰

## è®¸å¯è¯

MIT License

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒåŸºç¡€è½¨è¿¹å›æ”¾åŠŸèƒ½
- è¿›åº¦æ¡æ§åˆ¶å’Œæ—¶é—´æ˜¾ç¤º
- å¤šè½¨è¿¹åŒæ—¶æ’­æ”¾
- é”®ç›˜å¿«æ·é”®æ”¯æŒ
